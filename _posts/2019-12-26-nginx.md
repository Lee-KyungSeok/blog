---
layout: post
comments: true
title:  "[Nginx] Nginx 란"
date:   2019-12-26
author: Cory
categories: web
permalink : /dev/aws/eks-efs
tags: webserver nginx
---

웹서버를 사용할 때 요즘에는 대부분 nginx 를 많이 이용할 것으로 생각합니다. 그래서 이번에 공부하는 김에 nginx 에 대해서 한번 정리해보고자 블로그 작성을 하게 되었습니다.

## 웹 서버란? 

nginx 는 결국 웹 서버의 한 종류입니다. 그렇다면 웹 서버는 무엇일까요? 웹 서버란 이미지, 동영상, 자바스크립트, HTML, 등 다양한 문서를 제공하는 서버 시스템입니다. 주로 __HTTP__ 통신 프로토콜을 통해 리소스를 전달하지만 FTP, SMTP 와 같은 다른 프로토콜도 지원하는 것이 대부분입니다. 

<img src="https://lh3.googleusercontent.com/GVZfrps3asMhVmeVsZJBL5F5yMJERSszkUML3Gn-k4UYYL0DeJL4FbULitZtbYxi0ybffD7pShQRKeBAArlUOwO0aRKH19hfOYsSmSckRJCnCxBw-kiB2Ak1qWEw92rbwSA7bcUvGNZgvtMozM4WYDbAfmGwT7VN3UzdxfylagbbNrPzywTrI7qm1Yu7YvaK2BBRSIjqySMiGqSHwynnMgniW8v-JTcV46CqBvUBGYJy8H-5_N5bH6HhD9vBBvr3lPEcQFmhL1Xh7m57wBB-STpAN01jFaoLiR_B_CFZpyICf8tJK93XQ3k5Mn9JQsAQnQuiEzN7Eqm3qNnlwfdqzzwavHNtS6R6GFqPCT-R0rUDndFTkmhyovDgAdHshpi59ddJ87zhONaxEGiEwOA2P8PFT_iC6lPBQwP3Jhw05cjkKS0qUYxb0T1t1l0Tav1qpTDw5qaXdDfY-IEpV8XpCmXSaHOLjk_ffkkJBh7R_Yan78lGxDE2ZL1MGyq0sDnDtO5zloYt9xeBUYeGAz6n1aFZB7uXKuIgT4lhVZYTMeCh7dxcVyebTNwqBgUDp2ZLJgTOt3GbmJn2Q9FbQDQ-LtCDAifvY4ZHNQNi6AMJuX34TmgRdsBH2aL6n3RchZHINwCjPMSfeB6tz1qnIFwIzK6UicX047b1AJlQaG389ET-ucXHadyCvyY=w853-h205-no" alt="nginx-01">

대부분의 웹 서비스는 위의 아키텍처처럼 구성되어 있으며 웹서버는 그 중 다음과 같은 역할을 주로 담당하게 됩니다. 

1. 데이터 전송
   - HTML 텍스트 파일을 비롯하여 이미지나 음성 데이터 같은 정적인 컨텐츠를 웹 클라이언트에 전송합니다.
   - 이를 이용하면 최근 유행하는 클라이언트 사이드 랜더링(React, Vue, Angular 등)에 의해 생성된 빌드 파일(정적 파일)을 제공할 수 있습니다.
2. 어플리케이션 실행
   - 위 아키텍처와는 다르게 웹서버 내에 PHP 와 같은 모듈을 내장해서 웹 서버가 직접 Application Server 를 실행할 수 있습니다.
   - 이를 이용해 이미지 압축 등의 기능을 사용할 수 있게 됩니다.
3. 프록시 처리
   - 클라이언트의 요청을 Application Server 로 전달하는 역할을 합니다.
   - 이를 이용해 캐시 처리를 할 수 있고 로드 밸런싱 기능, 암호화 기능 등 처리할 수 있으며, 웹 서버가 사용되는 가장 큰 이유 중 하나이기도 합니다.

간단하게 웹서버에 대해서 알아봤습니다. 그럼 nginx 웹 서버는 어떤 특징을 가지고 있으며 왜 최근 사람들이 많이 사용하는지 알아보도록 하겠습니다. 

## nginx 특징

nginx 의 가장 큰 특징은 __비동기 Event Driven__ 에 의한 __Non Blocking__ 처리를 한다는 것입니다. 그에 따라 동시 접속수가 늘어날 수록 물리 메모리가 증가하는 프로세스 기반의 __apache 서버__ 에 비해 소비 메모리량이 적어지면서 동시 처리수를 급격하게 늘릴 수 있습니다. 

또한 single Thread 기반으로 __마스터 / worker__ 프로세스 구동 방식을 채택하여 __context switching__ 를 하지 않기 때문에 CPU 사용률을 감소시킬 수 있습니다.

<img src="https://lh3.googleusercontent.com/pxU_KeSwCoBOashzSOTYEQXetDlXvhKR7CeSsAfYAYJ0bWPyd2R7Wpe-ocMnXzI1oGCnuD6AQLypqtcF5Ppn52j9ngv6RjEEMKVUXXqSkL89LwlK7KsXbijVTqxacsEg1vsM2oRRUcFq-smbFzBB2_zCdKoK14r7AuLl6MLlhtvGFBtIYj3ZHkoGVO_EfYK3b8747yDJTcvyOZj8iq_YhsDohhGvP4PGZkwqREWU93oo37UA5k5Wa0Eo5kPWzPfHrwgjknjzUTinKCGVPa5MQZq_-VliiKOoU1taftWjzUvJeeKpsibJV5HP-hflXpwXKn1X0mCgSavP-hbbfbFjec37BHvbVcx31-xCQIV9epVmRGaN9F-I0m4jUx5Nx8QkIAj1UnKniB_SU4xvXb84DVj6m9_OE9uUoPZpnfRm6LPATlTC2fUk55Yx-11slF2XskYrFxTlnkD2w1rD7n6w2ugvevPWCxUvaumZlBnl7eRcGyaA9oGxhLXroRMBtXOkTwokLO2jgjwNfKqwx06Ti83qUGH-GNACwDDRvxF9YsaTlcjWc3Ojsawnq2JoljoIObsmcsIkAInu8_kMgtYuF1rimULihgmHRYXUaESuVXqZxxpgK_IXZtKONz0wnzPrsU-e3FjtJu99dIHyuaBUkkgXmSccd_pErhWM1a0QYR2LCLr4Al8y03Q=w1364-h381-no" alt="nginx-01">
(이미지 출처: [가그린 밀크 블로그](https://brainbackdoor.tistory.com/28))

다만 결국 하드웨어 자원을 사용하는 것이므로 nginx 에서 읽기/쓰기가 자주 일어난다면 아파치가 더 좋을 수도 있습니다. 하지만 대부분의 웹 서버에서는 하드웨어 읽기가 발생하지 않는 __캐시 제공__, __리버스 프록시 서버__, __로드 벨런서__ 등의 역할을 주로 담당하게 되므로 최근 자주 사용된다고 생각할 수 있을 것 같습니다.

그 외에도 nginx 는 여러 기능을 __모듈__ 단위로 개발하여 nginx 를 컴파일할 때 필요한 모듈들만 조합해서 사용할 수 있습니다. 

## nginx 사용하기


## 마무리



